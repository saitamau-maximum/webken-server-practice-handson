# Hono 3rd Practice - Advanced Blog Management System

## 概要
この課題では、Honoフレームワークを使用して高度なブログ管理システムを構築します。JWT認証、CRUD操作、検索機能、ページネーション、管理者機能など、実際のWebアプリケーションで使用される様々な機能を実装します。

## 学習目標
- Honoフレームワークの高度な機能を理解する
- JWT認証システムの実装
- RESTful APIの設計パターンを学ぶ
- ミドルウェアの概念と実装
- 検索・フィルタリング・ページネーション機能
- 管理者機能とロールベースアクセス制御
- セキュリティベストプラクティス

## 機能概要

### 認証システム
- ユーザー登録 (`POST /api/auth/register`)
- ログイン (`POST /api/auth/login`)
- JWT トークンベース認証
- パスワードハッシュ化 (bcrypt)

### ブログ投稿機能
- 投稿一覧取得 (`GET /api/posts`)
  - ページネーション対応
  - タイトル・内容での検索
  - カテゴリフィルタリング
  - タグフィルタリング
- 特定投稿取得 (`GET /api/posts/:id`)
- 投稿作成 (`POST /api/posts`) - 要認証
- 投稿更新 (`PUT /api/posts/:id`) - 要認証、作成者または管理者のみ
- 投稿削除 (`DELETE /api/posts/:id`) - 要認証、作成者または管理者のみ

### コメント機能
- コメント作成 (`POST /api/posts/:id/comments`) - 要認証
- コメント削除 (`DELETE /api/comments/:id`) - 要認証、作成者または管理者のみ

### カテゴリ機能
- カテゴリ一覧取得 (`GET /api/categories`)
- カテゴリ作成 (`POST /api/categories`) - 要認証、管理者のみ
- カテゴリ削除 (`DELETE /api/categories/:id`) - 要認証、管理者のみ

### 管理者機能
- 全ユーザー一覧取得 (`GET /api/users`) - 要認証、管理者のみ
- ユーザー削除 (`DELETE /api/users/:id`) - 要認証、管理者のみ
- ブログ統計情報取得 (`GET /api/stats`) - 要認証、管理者のみ

## 実装課題

### Practice版 - 実装が必要な機能
以下のTODOコメントがある**サーバーサイドの機能**を実装してください：

1. **投稿作成機能** (`app.post('/api/posts')`)
   - リクエストボディから title, content, categoryId, tags を取得
   - バリデーションを実施
   - 新しい投稿を作成（authorId は c.get('user').id を使用）
   - posts配列に追加
   - 作成された投稿を返す

2. **投稿更新機能** (`app.put('/api/posts/:id')`)
   - パラメータからpostIdを取得
   - 投稿が存在するかチェック
   - 作成者または管理者かチェック
   - リクエストボディから更新データを取得
   - 投稿を更新
   - 更新された投稿を返す

3. **投稿削除機能** (`app.delete('/api/posts/:id')`)
   - パラメータからpostIdを取得
   - 投稿が存在するかチェック
   - 作成者または管理者かチェック
   - 投稿を削除
   - 関連するコメントも削除
   - 削除成功メッセージを返す

4. **コメント作成機能** (`app.post('/api/posts/:id/comments')`)
   - パラメータからpostIdを取得
   - 投稿が存在するかチェック
   - リクエストボディからcontentを取得
   - バリデーションを実施
   - 新しいコメントを作成
   - comments配列に追加
   - 作成されたコメントを返す

5. **コメント削除機能** (`app.delete('/api/comments/:id')`)
   - パラメータからcommentIdを取得
   - コメントが存在するかチェック
   - 作成者または管理者かチェック
   - コメントを削除
   - 削除成功メッセージを返す

6. **カテゴリ作成機能** (`app.post('/api/categories')`)
   - リクエストボディから name, description を取得
   - バリデーションを実施
   - 新しいカテゴリを作成
   - categories配列に追加
   - 作成されたカテゴリを返す

7. **カテゴリ削除機能** (`app.delete('/api/categories/:id')`)
   - パラメータからcategoryIdを取得
   - カテゴリが存在するかチェック
   - そのカテゴリを使用している投稿があるかチェック
   - カテゴリを削除
   - 削除成功メッセージを返す

8. **ユーザー削除機能** (`app.delete('/api/users/:id')`)
   - パラメータからuserIdを取得
   - 削除対象のユーザーが存在するかチェック
   - 自分自身を削除しようとしていないかチェック
   - ユーザーを削除
   - そのユーザーの投稿とコメントも削除
   - 削除成功メッセージを返す

**注意**: フロントエンドは完全実装済みのため、サーバーサイドAPIの実装に集中してください。

## 技術スタック
- **バックエンド**: Hono, @hono/node-server
- **認証**: JWT (jsonwebtoken), bcryptjs
- **フロントエンド**: Vanilla JavaScript, HTML, CSS
- **データベース**: メモリ内配列（実際のプロジェクトではデータベースを使用）

## セットアップ方法

1. 依存関係のインストール:
   ```bash
   cd server
   npm install
   ```

2. サーバーの起動:
   ```bash
   npm start
   ```

3. クライアントの起動:
   ブラウザで `client/index.html` を開く

## デフォルトユーザー
- 管理者: `username=admin`, `password=password`
- 一般ユーザー: `username=user1`, `password=password`

## 実装のポイント

### セキュリティ
- JWTトークンによる認証
- パスワードのハッシュ化
- 認証ミドルウェアによるアクセス制御
- 管理者権限チェック
- XSS対策（HTMLエスケープ）

### API設計
- RESTful なエンドポイント設計
- 適切なHTTPステータスコードの使用
- エラーハンドリング
- バリデーション

### ユーザビリティ
- ページネーション
- 検索・フィルタリング機能
- レスポンシブデザイン
- 直感的なUI/UX

## 発展課題
Practice版の実装が完了したら、以下の機能を追加してみてください：

1. **投稿の下書き機能**
2. **いいね機能**
3. **投稿の閲覧数カウント**
4. **タグの自動補完**
5. **画像アップロード機能**
6. **Markdown対応**
7. **メール通知機能**
8. **ソーシャルログイン**

この課題を通じて、実際のWebアプリケーション開発で必要となる様々な技術とパターンを学ぶことができます。
